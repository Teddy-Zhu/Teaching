function userTreeonClick(e,r,t,c){curUserTreeNode=t,console.log(curUserTreeNode),$("#user_editname").val(curUserTreeNode.strname),$("#regcheck").iCheck(1==curUserTreeNode.intallowreg?"check":"uncheck")}function loadUserType(){$.ajax({url:"Type/GetUserTypeAllForType",type:"post",dataType:"json",success:function(e){nodes=$.fn.zTree.init($("#ul_tree_usertype"),usersetting,e),userTreeObj=$.fn.zTree.getZTreeObj("ul_tree_usertype"),userTreeObj.expandAll(!0),curUserTreeNode=null},async:!0})}var userTreeObj,usersetting={data:{key:{name:"strname",url:""},simpleData:{enable:!0,idKey:"intidentityid",rootPId:-1},view:{showLine:!0,showIcon:!0}},callback:{onClick:userTreeonClick}},curUserTreeNode=null;$(function(){$("#regcheck").iCheck({checkboxClass:"icheckbox_square-blue"}),$("#insertcheck").iCheck({checkboxClass:"icheckbox_square-blue"}),$(".icheckbox_square-blue").css("margin-top","5px"),$("#ul_tree_usertype").length>0&&loadUserType(),$(".usertype").click(function(){loadUserType()}),$("#user_edit").click(function(){var e,r=$("#user_editname").val().trim();return null==curUserTreeNode?void $.TeachDialog({content:"请至少选择一行!"}):""==r||void 0==r?void $.TeachDialog({content:"请输入一个名称!"}):(e=$("#regcheck").parent().hasClass("checked")?1:0,void $.ajax({url:"TypeOperate/UpdateUserType",type:"post",dataType:"json",data:{id:curUserTreeNode.intidentityid,allowreg:e,name:r},success:function(t){t?(curUserTreeNode.strname=r,curUserTreeNode.intallowreg=e,userTreeObj.updateNode(curUserTreeNode),$.TeachDialog({content:"更新用户类型成功!"})):$.TeachDialog({content:"更新用户类型失败!"})},async:!0}))}),$("#user_insert").click(function(){var e=$("#user_insertname").val().trim();return""==e||void 0==e?void $.TeachDialog({content:"请输入名称!"}):void $.ajax({url:"TypeOperate/InsertUserType",type:"post",dataType:"json",data:{allowreg:$("#insertcheck").parent().hasClass("checked")?1:0,name:e},success:function(r){isNaN(r)?$.TeachDialog({content:"新增用户类型失败!"}):(userTreeObj.addNodes(null,{intidentityid:parseInt(r),strname:e}),$.TeachDialog({content:"新增用户类型成功!"}))},async:!0})}),$("#user_delete").click(function(){return null==curUserTreeNode?void $.TeachDialog({content:"请至少选择一行!"}):void $.ajax({url:"TypeOperate/DeleteUserType",type:"post",dataType:"json",data:{id:curUserTreeNode.intidentityid},success:function(e){e?(treeObj.removeNode(curUserTreeNode),$.TeachDialog({content:"删除用户类型成功!"})):$.TeachDialog({content:"删除用户类型失败!"})},async:!0})}),$("[data-toggle='tooltip']").tooltip(),$("[data-toggle='tooltip']").click(function(){LoadAjaxContent("ajax/access_manage")})});