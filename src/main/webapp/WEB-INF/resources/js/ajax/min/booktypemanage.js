function bookTreeonClick(event,treeId,treeNode,clickFlag){curBookTreeNode=treeNode,$("#book_editname").val(curBookTreeNode.strbooktypename)}function loadBookType(){$.ajax({url:"Type/GetBookTypeForType",type:"post",dataType:"json",success:function(response){nodes=$.fn.zTree.init($("#ul_tree_booktype"),booksetting,response),bookTreeObj=$.fn.zTree.getZTreeObj("ul_tree_booktype"),bookTreeObj.expandAll(!0),curBookTreeNode=null},async:!0})}var bookTreeObj,booksetting={data:{key:{name:"strbooktypename",url:""},simpleData:{enable:!0,idKey:"intbooktypeid",rootPId:0},view:{showLine:!0,showIcon:!0}},callback:{onClick:bookTreeonClick}},curBookTreeNode=null;$(function(){$("#ul_tree_booktype").length>0&&loadBookType(),$(".booktype").click(function(){loadBookType()}),$("#book_edit").click(function(){var name=$("#book_editname").val().trim();return null==curBookTreeNode?void $.TeachDialog({title:"Operation Message!",content:"Please select a type to edit!"}):""==name||void 0==name?void $.TeachDialog({title:"Operation Message!",content:"Please Input a name!"}):void $.ajax({url:"TypeOperate/UpdateBookType",type:"post",dataType:"json",data:{id:curBookTreeNode.intbooktypeid,name:name},success:function(response){response?(curBookTreeNode.strbooktypename=name,bookTreeObj.updateNode(curBookTreeNode),$.TeachDialog({title:"Operation Message!",content:"Update BookType successfully!"})):$.TeachDialog({title:"Operation Message!",content:"Update BookType failed!"})},async:!0})}),$("#book_insert").click(function(){var name=$("#book_insertname").val().trim();return""==name||void 0==name?void $.TeachDialog({title:"Operation Message!",content:"Please Input a name!"}):void $.ajax({url:"TypeOperate/InsertBookType",type:"post",dataType:"json",data:{name:name},success:function(response){isNaN(response)?$.TeachDialog({title:"Operation Message!",content:"Insert BookType failed!"}):(bookTreeObj.addNodes(null,{intbooktypeid:parseInt(response),strbooktypename:name}),$.TeachDialog({title:"Operation Message!",content:"Insert BookType successfully!"}))},async:!0})}),$("#book_delete").click(function(){return null==curBookTreeNode?void $.TeachDialog({title:"Operation Message!",content:"Please select a type to edit!"}):void $.ajax({url:"TypeOperate/DeleteBookType",type:"post",dataType:"json",data:{id:curBookTreeNode.intbooktypeid},success:function(response){response?(bookTreeObj.removeNode(curBookTreeNode),$.TeachDialog({title:"Operation Message!",content:"Delete BookType successfully!"})):$.TeachDialog({title:"Operation Message!",content:"Delete BookType failed!"})},async:!0})})});